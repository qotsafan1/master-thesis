<!DOCTYPE html>
<html lang="en">
<head>
	<% include ../partials/head %>
</head>
<body class="container">

	<header>
		<% include ../partials/header %>
	</header>
	<br>	
	<div class="row" id="calendarDiv">

		<table id="calendar"></table>
	</div>
	<footer>
	<br>
		<% include ../partials/footer %>
	</footer>

</body>
<% include ../partials/annotations %>
</html>

<script src="scripts/data-processing.js"></script>

<script type='text/javascript'>	
	var dataset = document.getElementById("datasets");
	var event = new Event('change');
	dataset.dispatchEvent(event);

	function removeAllVisualizations() {
		var calendar = document.getElementById("calendarDiv");			
		while (calendar.firstChild) {
			calendar.removeChild(calendar.firstChild);
		}
	}

	function createVisualizations() {
		var firstDateOfYear = new Date(data['firstYear'], 0, 1);
		var firstDate = new Date(data['firstYear'], data['firstMonth'], 1);
		var lastDate = new Date(data['lastRecordedDay'].getMonth() === 11 ? data['lastYear']+1 : data['lastYear'], data['lastRecordedDay'].getMonth() === 11 ? 0 : (data['lastRecordedDay'].getMonth()+1), 1);

		var currentDate = new Date(firstDateOfYear.getFullYear(), firstDateOfYear.getMonth(), 15);
		while(currentDate.getTime() < lastDate.getTime()) {
			var calendarObject = new MonthCalendar("#calendarDiv", currentDate, data['sumOfEachDay'], data['mostInADay'], data);
			calendarObject.create();	
			currentDate = new Date(
				currentDate.getMonth() === 11 ? currentDate.getFullYear()+1 : currentDate.getFullYear(),
				currentDate.getMonth() === 11 ? 0 : currentDate.getMonth()+1,
				15
			);
		}	
	}
</script>